{% extends 'base.html' %}

{% load humanize %}
{% block content %}

    <main>
        <!-- About US Start -->
        <div class="about-area">
            <div class="container">
                    <!-- Hot Aimated News Tittle-->
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="trending-tittle">
                                <strong>Trending now</strong>
                                <!-- <p>Rem ipsum dolor sit amet, consectetur adipisicing elit.</p> -->
                                <div class="trending-animated">
                                    <ul id="js-news" class="js-hidden">
                                        <li class="news-item">Bangladesh dolor sit amet, consectetur adipisicing elit.</li>
                                        <li class="news-item">Spondon IT sit amet, consectetur.......</li>
                                        <li class="news-item">Rem ipsum dolor sit amet, consectetur adipisicing elit.</li>
                                    </ul>
                                </div>
                                
                            </div>
                        </div>
                    </div>

                    {% if news %}
                   <div class="row">
                        <div class="col-lg-8">
                            <!-- Trending Tittle -->
                            <div class="about-right mb-90">
                                <div class="about-img">
                                    <img src="{{ news.feature_image.url }}" alt="">
                                </div>
                                <div class="section-tittle mb-30 pt-30">
                                    <h3>{{ news.title }}</h3>
                                </div>
                                <div class="about-prea">
                                {{ news.description }}
                                </div> 
                                <div class="section-tittle">
                                    <h3>Unordered list style?</h3>
                                </div>
                               
                                <div class="social-share pt-30">
                                    <div class="section-tittle">
                                        <h3 class="mr-20">Share:</h3>
                                        <ul>
                                            <li><a href="#"><img src="assets/img/news/icon-ins.png" alt=""></a></li>
                                            <li><a href="#"><img src="assets/img/news/icon-fb.png" alt=""></a></li>
                                            <li><a href="#"><img src="assets/img/news/icon-tw.png" alt=""></a></li>
                                            <li><a href="#"><img src="assets/img/news/icon-yo.png" alt=""></a></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>



                            <!-- From -->
                            <div class="row">
                                <div class="col-lg-12">
                                <h2> Comments({{ comments.count }})</h2>
                                    {% if user.is_authenticated %}

                                    <form class="form-contact mb-80" action="{% url 'handle-comment' %}" method="POST">
                                        {% csrf_token %}
                                        <div class="row">
                                      
                                            <div class="col-12">
                                                <div class="form-group">
                                                    <input type="hidden" name="news_id" value={{news.id}}>
                                                    <input type="hidden" name="parent_id" value="">

                                                    <textarea class="form-control w-100 error" name="message" id="message" cols="30" rows="4" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter Message'" placeholder="Enter Message"></textarea>
                                                </div>
                                            </div>
                                            
                                        </div>
                                        
                                            <button type="submit" class="button button-contactForm boxed-btn">Comment</button>
                                        
                                    </form>
                                    {% else %}
                                    <p class="alert danger">Please login to comment.</p>
                                    {% endif %}


                                  
                                </div>
                            </div>

                               
                        </div>
                        <div class="col-lg-4">
                            <!-- Section Tittle -->
                            <div class="section-tittle mb-40">
                                <h3>Follow Us</h3>
                            </div>
                            <!-- Flow Socail -->
                            <div class="single-follow mb-45">
                                <div class="single-box">
                                    <div class="follow-us d-flex align-items-center">
                                        <div class="follow-social">
                                            <a href="#"><img src="assets/img/news/icon-fb.png" alt=""></a>
                                        </div>
                                        <div class="follow-count">  
                                            <span>8,045</span>
                                            <p>Fans</p>
                                        </div>
                                    </div> 
                                    <div class="follow-us d-flex align-items-center">
                                        <div class="follow-social">
                                            <a href="#"><img src="assets/img/news/icon-tw.png" alt=""></a>
                                        </div>
                                        <div class="follow-count">
                                            <span>8,045</span>
                                            <p>Fans</p>
                                        </div>
                                    </div>
                                        <div class="follow-us d-flex align-items-center">
                                        <div class="follow-social">
                                            <a href="#"><img src="assets/img/news/icon-ins.png" alt=""></a>
                                        </div>
                                        <div class="follow-count">
                                            <span>8,045</span>
                                            <p>Fans</p>
                                        </div>
                                    </div>
                                    <div class="follow-us d-flex align-items-center">
                                        <div class="follow-social">
                                            <a href="#"><img src="assets/img/news/icon-yo.png" alt=""></a>
                                        </div>
                                        <div class="follow-count">
                                            <span>8,045</span>
                                            <p>Fans</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- New Poster -->
                            <div class="news-poster d-none d-lg-block">
                                <img src="assets/img/news/news_card.jpg" alt="">
                            </div>
                        </div>
                   </div>

                   {% endif %}
            </div>
        </div>
        {% for comment in comments %}
            <div class="row comment-container">
                <div class="col-2">
                <div class="img">
                
                    <img src="{{ comment.author.profile.profile_pic.url }}" alt="">
                </div>
                </div>
                <div class="comment-section col-10">
                    <strong>{{ comment.author.username }}</strong> at {{comment.create_at|naturaltime}}
                    <div>
                        {{ comment.comment_text}}
                    </div>
                    <div class="reply mx-0">
                        
                        <a class="btn btn-sm btn-primary my-2" data-toggle="collapse" href="#replyBox-{{comment.id}}" role="button" aria-expanded="false" aria-controls="replyBox-{{comment.id}}">
                            Reply
                        </a>
                        
                        <div class="collapse" id="replyBox-{{comment.id}}">
                        <div class="card card-body">


                            {% if user.is_authenticated %}

                                <form class="form-group my-80" action="{% url 'handle-comment' %}" method="POST">
                                    {% csrf_token %}
                                    <div class="row">
                                        post a reply
                                        <div class="col-12">
                                            <div class="form-group">
                                                <input type="hidden" name="news_id" value={{news.id}}>
                                                <input type="hidden" name="parent_id" value={{comment.id}}>
                                                <textarea class="form-control w-100 error" name="message" id="message" cols="30" rows="4" onfocus="this.placeholder = ''" onblur="this.placeholder = 'Enter Message'" placeholder="Enter Message"></textarea>
                                            </div>
                                        </div>
                                        
                                    </div>
                                    
                                        <button type="submit" class="btn btn-sm">Comment</button>
                                    
                                </form>
                                {% else %}
                                <p class="alert danger">Please login to comment.</p>
                            {% endif %}

                            <div class="replies my-2">
                                {% for reply in replies %}
                                    {% if reply.is_parent.id == comment.id %}
                                    <div class="row my-2">
                                        <div class="col-2">
                                            <div class="img">
                                            <img src="{{ reply.author.profile.profile_pic.url }}" alt="">
                                            </div>
                                        </div>

                                        <div class="col-10">
                                            <strong>{{reply.author.username }}</strong> <span>{{ reply.create_at|naturaltime }}</span>
                                            <p>
                                            {{ reply.comment_text }}
                                            </p>
                                        </div>
                                    </div>
                                    <br>
                                    {% endif %}
                                {% endfor %}
                            </div>
                                
                        </div>
                        </div>
                    
                    </div>
                </div>
            </div>
            
            {% endfor %}
        <!-- About US End -->
    </main>
{% endblock %}